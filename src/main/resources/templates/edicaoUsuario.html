<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ToDaily - Edicao</title>
    <link rel="stylesheet" href="/css/cadastro.css" />
</head>
<body>
<div class="logo">
    <img src="/img/logo.png" alt="ToDaily logo" />

</div>

<div class="cadastro-container">
    <h2>Edição Usuario</h2>

    <p th:text="${mensagem}" style="color: lightgreen; text-align:center;"></p>

    <form id="cadastroForm" action="/edicaoUsuario" method="post" onsubmit="return validarFormulario()" th:object="${usuario}">

        <label for="nome">Nome*:</label>
        <input type="text" id="nome" name="nome" th:value="*{nome}" required />

        <label for="email">e-mail*:</label>
        <input type="email" id="email" name="email" th:value="*{email}" required />

        <label for="dataNasc">Data de Nascimento*:</label>
        <input type="text" id="dataNasc" name="dataNascimento" th:value="*{dataNascimento}" placeholder="DD/MM/AAAA" required />

        <label for="senha">Senha*:</label>
        <input type="password" id="senha" name="senha" th:value="*{senha}" minlength="8" required />

        <label for="confirmar">Confirmar Senha*:</label>
        <input type="password" id="confirmar" name="confirmarSenha" th:value="*{senha}" minlength="8" required />

        <p class="info">(*) São campos obrigatórios</p>

        <div class="botoes">
            <button  type="button" class="btn" onclick="window.location.href='/menuPrincipal'">Cancelar</button>
            <button type="submit" class="btn">Confirmar</button>
        </div>
    </form>

    <!-- Mensagem de erro -->
    <p id="erro" style="color: #ff5555; text-align:center; margin-top:10px;"></p>
</div>

<script>
    function validarFormulario() {
        const dataNasc = document.getElementById("dataNasc").value.trim();
        const senha = document.getElementById("senha").value.trim();
        const confirmar = document.getElementById("confirmar").value.trim();
        const erro = document.getElementById("erro");

        // Limpa mensagens anteriores
        erro.textContent = "";

        // Validação de data no formato dd/mm/aaaa
        const regexData = /^(0[1-9]|[12][0-9]|3[01])\/(0[1-9]|1[0-2])\/\d{4}$/;
        if (!regexData.test(dataNasc)) {
            erro.textContent = "A data de nascimento deve estar no formato DD/MM/AAAA.";
            return false;
        }

        // Validação de senha mínima
        if (senha.length < 8) {
            erro.textContent = "A senha deve ter pelo menos 8 caracteres.";
            return false;
        }

        // Validação de confirmação de senha
        if (senha !== confirmar) {
            erro.textContent = "As senhas não coincidem.";
            return false;
        }

        // Tudo certo — envia o formulário
        return true;
    }
</script>
</body>
</html>